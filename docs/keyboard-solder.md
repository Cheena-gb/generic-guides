# ハンダ作業 キーボード製作用ガイド
自作キーボードのハンダ作業は、概ね以下の作業を行うことにより完了できます。  
※個別にビルドガイドのあるキーボードでは、それぞれのビルドガイドに従ってください。

## 工具類の用意
### 作業に必要なもの
- ハンダ作業一式
  - ハンダゴテ
  - ハンダ
  - コテ台
- ニッパー
- ピンセット
  
### あると作業が楽になるもの
  - 作業マット  
  - ハンダ回収機  
  - ハンダ回収線  
  - フラックス  
  - フラックスリムーバー  
 
### 必要であろうパーツ類
- ダイオード
- キーソケット
- MCU
- ピンソケット・ピンヘッダ・コンスルー
- LED

## 実作業
基本は小さいもの、背の低いもの、後々邪魔にならないものからハンダづけしていきます。  
特に、NeoPixel系[^1]LEDのSK6812MINI-Eなどといった背が低く、ハンダづけを行うべき箇所が多い部品は特に優先して処理しておくべき部品となります。  
[^1]:フルカラーで光る、ICチップ内蔵のLED。

### SK6812MINI-Eのハンダづけ
4本の足を持つ、フルカラーLEDの一種です。回路設計が容易なため自作キーボードで採用されることが多いLEDの一つであり、同時にハンダ作業最高難易度を誇る部品でもあります。  
専用に開けられた四角穴の中に筐体を落とし込み、LEDの足を1本ずつハンダづけしていきます。このとき、全部の足をいっぺんにハンダづけするのではなく、1本やって次のLED、という風に進むとICチップの加熱を防ぐことができます。  
また、一見ハンダが十分に盛られていると見えても、実際は足とパッドが接続していないというハンダ不良もよくあります。ごく薄く予備ハンダを行うことや、足とパッドの全体を覆うようにハンダを乗せることで導通を確実にします。  
  
作業時には予備ハンダ[^2]を行わず、パッドに直接足が当たるように配置します。  
基本的に、パッドの方が足より広く作られているので、パッドにハンダゴテの先を当て、足の方にハンダを当てることで、ハンダが溶けてパッド側に流れ込んだ一瞬後にハンダゴテとハンダを同時に離します。  
こうすることにより、ハンダのクオリティはともかく、LEDの固定自体は行えるようになります。  
この状態で、残りの足3本も固定し、最後に足全体にフラックスを塗って再度ハンダを溶かし、固めることで滑らかなフィレットを持つハンダにすることができます。

[^2]:先にパッドにハンダを付けておくこと。

### ダイオードのハンダづけ
1N4148シリーズのダイオードを採用したものが大半です。リードタイプと表面実装タイプの2種類があり、基板によってどちらに対応しているかが異なります。  
基板の表示であるシルクスクリーンの矢印→|の縦線のある方向と、ダイオードの表面に書いてある線を合わせ、はんだづけを行います。  

リードタイプを使用する際は先にリードを曲げ、スルーホールに差し込んでハンダづけします。  
ハンダは基板裏(部品のある側ではなく、リードのある方向)から行い、ニッパーで短く切り詰めます。
  
表面実装タイプを使用する際は先にパッドにハンダを少し載せておきます。これを予備ハンダといいます。  
この状態でピンセットでダイオードをつかみ、予備ハンダを溶かしてダイオードを固定し、反対側の足もハンダづけしたら、最後に予備ハンダを行った方にわずかにハンダを追加してフィレットを再形成します。  
もし予備ハンダが多すぎて追加すると玉になってしまうという場合は、フラックスを塗って再度溶かし固めてください。

### キーソケットのハンダづけ
キースイッチの交換を可能にする部品であるソケットは、キースイッチのピンの配置に合わせて複数の種類が存在します。  
有名なものはMXタイプ、Kailh Chocタイプ、Gateron Low Profileタイプとなっており、それぞれ形状が異なります。  
作業内容としてはどれも同様となり、それぞれ予備ハンダを行い、ソケットを乗せて予備ハンダを溶かし、浮きがないことを確認してもう片方の足をハンダづけします。  
予備ハンダをしない場合は、ソケットの横からハンダを導入します。  
ハンダを導入しすぎると、接点部がヤニでメッキされてしまって導通しなくなったり、ハンダ自体の強度で接点が硬くなったりするため、注意が必要です。  
ソケット自体の保持はパッドとハンダのみで行っているため、足からパッドにハンダがなめらかに接続されており、パッド自体が見えている部分がない(上から見て3方向にハンダの傾斜が出来ている)状態であれば問題ありません。  
足を真横から見た際の四角い穴が2～3割程度埋まる程度であれば問題なく、8割以上がハンダで埋まるようになると導通不良の可能性が出てきます。  
なお、ハンダに力がかかるのはキースイッチを挿入する際だけであり、通常の使用時にはスイッチプレートと基板が力を受けるようになっているはずです。  

### (レア)Mill-Maxソケットのハンダづけ
ピン1本に対して1つ使用する小型の金属筒型ソケット「Mill-Max」は、特にハンダ難易度の高いパーツの一つです。  
ソケットを基板表から挿入し、裏からはんだづけすることで固定と導通を行いますが、筒内部にハンダが流れ込んでしまうとソケットとしての機能を失い、ただの金属の塊になってしまいます。  
これを回避するには、ソケットを挿入する前にハンダ面にフラックスを塗っておき、はんだづけの際はコテ先を当てている部分と反対側にハンダを当てて加熱を待つのが、最も成功率が高い作業方法となります。  
Mill-Maxは金属パーツであり、あまり過熱を気にする必要はありません。ゆっくりと作業を行いましょう。  
とはいえ、ソケット自体が高価であること、入手性が悪く作業が大変なことから採用例は多くありません。安心しましょう。

### (レア)Holtiteソケットのハンダづけ
Mill-Maxと並んで使用されることの多い金属ソケット「Holtite Socket」は、金属筒の下側に切れ込みが入っており、キーボードの設計によって特殊な実装方法を求められます。  
Holtite対応かつ、スイッチとのスルーホールが十分に小さい場合、基板表からHoltiteを挿入し、熱した綺麗なハンダゴテで押し込むことで固定が可能です[^3]。  
ハンダがわずかでも付着してしまうと動作不良の原因になるため、新品のコテ先を用意するか、ワイヤータイプのコテ先クリーナーでしっかりと清掃する必要があります。  
スルーホールが大きく、Holtiteの確実な固定が見込めない場合、裏側からハンダ付けする必要がありますが、フラックスを塗るとHoltiteの内部に流入してしまう可能性があるため、フラックスは使わずに端をごくわずかな量のハンダで固定してください。  

[^3]:スルーホールに施されたHASL(熱風ハンダメッキ)によるハンダが固定しています。

### ピンソケット・ピンヘッダ・コンスルーなどのハンダづけ
キーボードのMCUの交換を可能にするため、ソケットやコンスルー(スプリングヘッダ)を使用することがよくあります。  
ピンソケットは、ビルドガイドに記載のある方向に導入し、マスキングテープで固定して、裏側の足をハンダづけします。  
ピンヘッダはピンソケットに挿したうえでMCUをのせ、MCUとピンヘッダをハンダづけするとうまくいきます。  
※ピンソケットをハンダ付けしていない状態でピンヘッダを挿入しないでください  
  
コンスルーは内部に特殊な形状のばねが入っており、差し込みだけでも導通するようになっています。  
しかし、通常のPro Microではスルーホールのサイズがコンスルー非対応となっていることが多いです[^4]:。  
ハンダ付けを行う場合は、脱落防止ピンがわずかに見える"窓"をPro Micro側に寄せ、そして両方のコンスルーの窓のある向きを揃えるとよいとされています。  
理由については諸説ありますが、考えられる要素としては、  
- そもそもコンスルーはハンダ付けを前提とした構造ではない
- が、Pro Microは穴が広すぎるので固定のためにハンダ付けが必要
- ハンダで固定することでピンのばね構造が失われてしまう
- また、脱落防止ピンのある方のピンは細すぎる穴に導入するとピンを導通不良の発生しうる位置に固定してしまう可能性がある[^5]
- このため、事故の発生しづらい方をPro Micro側に固定している
  
と考えられます。  
窓の向きを揃える理由については不明なので割愛します(とはいえ、経験則として揃えない場合は導通不良が発生することがありようです)。

[^4]:Pro Microのスルーホール：約1mm　コンスルーの対応径：0.8～0.9mm
[^5]:内部的には、Cの形をしたピンの終端に外向きに脱落防止ピンが突き出ている状態なので、脱落防止ピンが押し込まれすぎて窓から外れると、その位置で固定してしまう

### ジャンパーのハンダ付け
左右分割キーボートなどでは2つ並んだパッドにハンダを盛って接続する作業が発生することがあります。  
この作業はハンダの粘性を利用した作業のため、フラックスを塗らず、ハンダに含まれるヤニだけで作業を進めることをお勧めします。  
両方のパッドに予備ハンダを盛り、十分そうな量になったところで2つのハンダを同時に溶かすイメージでハンダを加熱すると、だいたいうまくいきます。  
これが難しい場合、リード足や配線材などを用いて接続します。  
リード足などを両方のパッドに被るように乗せ、マスキングテープなどで片方のパッドが露出するように固定します。  
パッドとリードを十分に加熱し、わずかにハンダを送って、固定できたら、マスキングテープをハンダ付けした方に移し[^6]、もう片方もハンダ付けします。
[^6]:配線材が短いと、すぐに加熱してしまい、既存のハンダも溶かしてしまうため
